[
    {
        "label": "cv2",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "cv2",
        "description": "cv2",
        "detail": "cv2",
        "documentation": {}
    },
    {
        "label": "time",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "time",
        "description": "time",
        "detail": "time",
        "documentation": {}
    },
    {
        "label": "threading",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "threading",
        "description": "threading",
        "detail": "threading",
        "documentation": {}
    },
    {
        "label": "asyncio",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "asyncio",
        "description": "asyncio",
        "detail": "asyncio",
        "documentation": {}
    },
    {
        "label": "Queue",
        "importPath": "queue",
        "description": "queue",
        "isExtraImport": true,
        "detail": "queue",
        "documentation": {}
    },
    {
        "label": "Empty",
        "importPath": "queue",
        "description": "queue",
        "isExtraImport": true,
        "detail": "queue",
        "documentation": {}
    },
    {
        "label": "Full",
        "importPath": "queue",
        "description": "queue",
        "isExtraImport": true,
        "detail": "queue",
        "documentation": {}
    },
    {
        "label": "numpy",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "numpy",
        "description": "numpy",
        "detail": "numpy",
        "documentation": {}
    },
    {
        "label": "os",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "os",
        "description": "os",
        "detail": "os",
        "documentation": {}
    },
    {
        "label": "datetime",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "datetime",
        "description": "datetime",
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "datetime",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "datetime",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "platform",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "platform",
        "description": "platform",
        "detail": "platform",
        "documentation": {}
    },
    {
        "label": "insert_log",
        "importPath": "services.database",
        "description": "services.database",
        "isExtraImport": true,
        "detail": "services.database",
        "documentation": {}
    },
    {
        "label": "DatabaseManager",
        "importPath": "services.database",
        "description": "services.database",
        "isExtraImport": true,
        "detail": "services.database",
        "documentation": {}
    },
    {
        "label": "save_session",
        "importPath": "services.database",
        "description": "services.database",
        "isExtraImport": true,
        "detail": "services.database",
        "documentation": {}
    },
    {
        "label": "DatabaseManager",
        "importPath": "services.database",
        "description": "services.database",
        "isExtraImport": true,
        "detail": "services.database",
        "documentation": {}
    },
    {
        "label": "HeadGestureDetector",
        "importPath": "services.vision_analysis",
        "description": "services.vision_analysis",
        "isExtraImport": true,
        "detail": "services.vision_analysis",
        "documentation": {}
    },
    {
        "label": "crop_face_with_mediapipe",
        "importPath": "services.vision_analysis",
        "description": "services.vision_analysis",
        "isExtraImport": true,
        "detail": "services.vision_analysis",
        "documentation": {}
    },
    {
        "label": "estimate_plate_leftover",
        "importPath": "services.vision_analysis",
        "description": "services.vision_analysis",
        "isExtraImport": true,
        "detail": "services.vision_analysis",
        "documentation": {}
    },
    {
        "label": "detect_food_regions_yolo",
        "importPath": "services.vision_analysis",
        "description": "services.vision_analysis",
        "isExtraImport": true,
        "detail": "services.vision_analysis",
        "documentation": {}
    },
    {
        "label": "llm_handler",
        "importPath": "services",
        "description": "services",
        "isExtraImport": true,
        "detail": "services",
        "documentation": {}
    },
    {
        "label": "llm_handler",
        "importPath": "services",
        "description": "services",
        "isExtraImport": true,
        "detail": "services",
        "documentation": {}
    },
    {
        "label": "vision_analysis",
        "importPath": "services",
        "description": "services",
        "isExtraImport": true,
        "detail": "services",
        "documentation": {}
    },
    {
        "label": "llm_handler",
        "importPath": "services",
        "description": "services",
        "isExtraImport": true,
        "detail": "services",
        "documentation": {}
    },
    {
        "label": "llm_handler",
        "importPath": "services",
        "description": "services",
        "isExtraImport": true,
        "detail": "services",
        "documentation": {}
    },
    {
        "label": "vision_analysis",
        "importPath": "services",
        "description": "services",
        "isExtraImport": true,
        "detail": "services",
        "documentation": {}
    },
    {
        "label": "database",
        "importPath": "services",
        "description": "services",
        "isExtraImport": true,
        "detail": "services",
        "documentation": {}
    },
    {
        "label": "config",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "config",
        "description": "config",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "analyze_plate_vlm",
        "importPath": "services.llm_handler",
        "description": "services.llm_handler",
        "isExtraImport": true,
        "detail": "services.llm_handler",
        "documentation": {}
    },
    {
        "label": "identify_food_item  # ★ [NEW] 記得引入這個！",
        "importPath": "services.llm_handler",
        "description": "services.llm_handler",
        "isExtraImport": true,
        "detail": "services.llm_handler",
        "documentation": {}
    },
    {
        "label": "dataclass",
        "importPath": "dataclasses",
        "description": "dataclasses",
        "isExtraImport": true,
        "detail": "dataclasses",
        "documentation": {}
    },
    {
        "label": "field",
        "importPath": "dataclasses",
        "description": "dataclasses",
        "isExtraImport": true,
        "detail": "dataclasses",
        "documentation": {}
    },
    {
        "label": "dataclass",
        "importPath": "dataclasses",
        "description": "dataclasses",
        "isExtraImport": true,
        "detail": "dataclasses",
        "documentation": {}
    },
    {
        "label": "dataclass",
        "importPath": "dataclasses",
        "description": "dataclasses",
        "isExtraImport": true,
        "detail": "dataclasses",
        "documentation": {}
    },
    {
        "label": "Optional",
        "importPath": "typing",
        "description": "typing",
        "isExtraImport": true,
        "detail": "typing",
        "documentation": {}
    },
    {
        "label": "Dict",
        "importPath": "typing",
        "description": "typing",
        "isExtraImport": true,
        "detail": "typing",
        "documentation": {}
    },
    {
        "label": "Any",
        "importPath": "typing",
        "description": "typing",
        "isExtraImport": true,
        "detail": "typing",
        "documentation": {}
    },
    {
        "label": "Iterable",
        "importPath": "typing",
        "description": "typing",
        "isExtraImport": true,
        "detail": "typing",
        "documentation": {}
    },
    {
        "label": "Optional",
        "importPath": "typing",
        "description": "typing",
        "isExtraImport": true,
        "detail": "typing",
        "documentation": {}
    },
    {
        "label": "Dict",
        "importPath": "typing",
        "description": "typing",
        "isExtraImport": true,
        "detail": "typing",
        "documentation": {}
    },
    {
        "label": "Any",
        "importPath": "typing",
        "description": "typing",
        "isExtraImport": true,
        "detail": "typing",
        "documentation": {}
    },
    {
        "label": "Optional",
        "importPath": "typing",
        "description": "typing",
        "isExtraImport": true,
        "detail": "typing",
        "documentation": {}
    },
    {
        "label": "Dict",
        "importPath": "typing",
        "description": "typing",
        "isExtraImport": true,
        "detail": "typing",
        "documentation": {}
    },
    {
        "label": "Any",
        "importPath": "typing",
        "description": "typing",
        "isExtraImport": true,
        "detail": "typing",
        "documentation": {}
    },
    {
        "label": "List",
        "importPath": "typing",
        "description": "typing",
        "isExtraImport": true,
        "detail": "typing",
        "documentation": {}
    },
    {
        "label": "Tuple",
        "importPath": "typing",
        "description": "typing",
        "isExtraImport": true,
        "detail": "typing",
        "documentation": {}
    },
    {
        "label": "List",
        "importPath": "typing",
        "description": "typing",
        "isExtraImport": true,
        "detail": "typing",
        "documentation": {}
    },
    {
        "label": "Dict",
        "importPath": "typing",
        "description": "typing",
        "isExtraImport": true,
        "detail": "typing",
        "documentation": {}
    },
    {
        "label": "Tuple",
        "importPath": "typing",
        "description": "typing",
        "isExtraImport": true,
        "detail": "typing",
        "documentation": {}
    },
    {
        "label": "Any",
        "importPath": "typing",
        "description": "typing",
        "isExtraImport": true,
        "detail": "typing",
        "documentation": {}
    },
    {
        "label": "annotations",
        "importPath": "__future__",
        "description": "__future__",
        "isExtraImport": true,
        "detail": "__future__",
        "documentation": {}
    },
    {
        "label": "annotations",
        "importPath": "__future__",
        "description": "__future__",
        "isExtraImport": true,
        "detail": "__future__",
        "documentation": {}
    },
    {
        "label": "defaultdict",
        "importPath": "collections",
        "description": "collections",
        "isExtraImport": true,
        "detail": "collections",
        "documentation": {}
    },
    {
        "label": "deque",
        "importPath": "collections",
        "description": "collections",
        "isExtraImport": true,
        "detail": "collections",
        "documentation": {}
    },
    {
        "label": "deque",
        "importPath": "collections",
        "description": "collections",
        "isExtraImport": true,
        "detail": "collections",
        "documentation": {}
    },
    {
        "label": "deque",
        "importPath": "collections",
        "description": "collections",
        "isExtraImport": true,
        "detail": "collections",
        "documentation": {}
    },
    {
        "label": "deque",
        "importPath": "collections",
        "description": "collections",
        "isExtraImport": true,
        "detail": "collections",
        "documentation": {}
    },
    {
        "label": "Counter",
        "importPath": "collections",
        "description": "collections",
        "isExtraImport": true,
        "detail": "collections",
        "documentation": {}
    },
    {
        "label": "Counter",
        "importPath": "collections",
        "description": "collections",
        "isExtraImport": true,
        "detail": "collections",
        "documentation": {}
    },
    {
        "label": "Counter",
        "importPath": "collections",
        "description": "collections",
        "isExtraImport": true,
        "detail": "collections",
        "documentation": {}
    },
    {
        "label": "Counter",
        "importPath": "collections",
        "description": "collections",
        "isExtraImport": true,
        "detail": "collections",
        "documentation": {}
    },
    {
        "label": "pandas",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "pandas",
        "description": "pandas",
        "detail": "pandas",
        "documentation": {}
    },
    {
        "label": "sqlite3",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "sqlite3",
        "description": "sqlite3",
        "detail": "sqlite3",
        "documentation": {}
    },
    {
        "label": "json",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "json",
        "description": "json",
        "detail": "json",
        "documentation": {}
    },
    {
        "label": "base64",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "base64",
        "description": "base64",
        "detail": "base64",
        "documentation": {}
    },
    {
        "label": "io",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "io",
        "description": "io",
        "detail": "io",
        "documentation": {}
    },
    {
        "label": "httpx",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "httpx",
        "description": "httpx",
        "detail": "httpx",
        "documentation": {}
    },
    {
        "label": "AsyncOpenAI",
        "importPath": "openai",
        "description": "openai",
        "isExtraImport": true,
        "detail": "openai",
        "documentation": {}
    },
    {
        "label": "ChatCompletion",
        "importPath": "openai.types.chat",
        "description": "openai.types.chat",
        "isExtraImport": true,
        "detail": "openai.types.chat",
        "documentation": {}
    },
    {
        "label": "Image",
        "importPath": "PIL",
        "description": "PIL",
        "isExtraImport": true,
        "detail": "PIL",
        "documentation": {}
    },
    {
        "label": "load_prompt_template",
        "importPath": "utils.prompt_loader",
        "description": "utils.prompt_loader",
        "isExtraImport": true,
        "detail": "utils.prompt_loader",
        "documentation": {}
    },
    {
        "label": "mediapipe",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "mediapipe",
        "description": "mediapipe",
        "detail": "mediapipe",
        "documentation": {}
    },
    {
        "label": "YOLO",
        "importPath": "ultralytics",
        "description": "ultralytics",
        "isExtraImport": true,
        "detail": "ultralytics",
        "documentation": {}
    },
    {
        "label": "streamlit",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "streamlit",
        "description": "streamlit",
        "detail": "streamlit",
        "documentation": {}
    },
    {
        "label": "ast",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "ast",
        "description": "ast",
        "detail": "ast",
        "documentation": {}
    },
    {
        "label": "plotly.express",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "plotly.express",
        "description": "plotly.express",
        "detail": "plotly.express",
        "documentation": {}
    },
    {
        "label": "LiveAnalyzer",
        "importPath": "core.live_analyzer",
        "description": "core.live_analyzer",
        "isExtraImport": true,
        "detail": "core.live_analyzer",
        "documentation": {}
    },
    {
        "label": "lru_cache",
        "importPath": "functools",
        "description": "functools",
        "isExtraImport": true,
        "detail": "functools",
        "documentation": {}
    },
    {
        "label": "BodyEmotionDetector",
        "importPath": "services.detectors",
        "description": "services.detectors",
        "isExtraImport": true,
        "detail": "services.detectors",
        "documentation": {}
    },
    {
        "label": "EmotionSatisfactionAnalyzer",
        "importPath": "services.analyzer",
        "description": "services.analyzer",
        "isExtraImport": true,
        "detail": "services.analyzer",
        "documentation": {}
    },
    {
        "label": "live_view",
        "importPath": "ui",
        "description": "ui",
        "isExtraImport": true,
        "detail": "ui",
        "documentation": {}
    },
    {
        "label": "video_view",
        "importPath": "ui",
        "description": "ui",
        "isExtraImport": true,
        "detail": "ui",
        "documentation": {}
    },
    {
        "label": "dashboard_view",
        "importPath": "ui",
        "description": "ui",
        "isExtraImport": true,
        "detail": "ui",
        "documentation": {}
    },
    {
        "label": "login_view",
        "importPath": "ui",
        "description": "ui",
        "isExtraImport": true,
        "detail": "ui",
        "documentation": {}
    },
    {
        "label": "state_manager",
        "importPath": "utils",
        "description": "utils",
        "isExtraImport": true,
        "detail": "utils",
        "documentation": {}
    },
    {
        "label": "localization",
        "importPath": "utils",
        "description": "utils",
        "isExtraImport": true,
        "detail": "utils",
        "documentation": {}
    },
    {
        "label": "load_dotenv",
        "importPath": "dotenv",
        "description": "dotenv",
        "isExtraImport": true,
        "detail": "dotenv",
        "documentation": {}
    },
    {
        "label": "DeepFace",
        "importPath": "deepface",
        "description": "deepface",
        "isExtraImport": true,
        "detail": "deepface",
        "documentation": {}
    },
    {
        "label": "LiveAnalyzer",
        "kind": 6,
        "importPath": "core.live_analyzer",
        "description": "core.live_analyzer",
        "peekOfCode": "class LiveAnalyzer:\n    def __init__(self, model_pack: dict, menu_items: list, analysis_options: dict, db_manager):\n        self.model_pack = model_pack\n        self.menu_items = menu_items\n        self.analysis_options = analysis_options\n        self._face_display_queue = Queue(maxsize=1)\n        self._face_analysis_queue = Queue(maxsize=1)\n        self._plate_display_queue = Queue(maxsize=1)\n        self._plate_analysis_queue = Queue(maxsize=1)\n        # 結果佇列維持一個，因為我們要合併結果傳給 UI",
        "detail": "core.live_analyzer",
        "documentation": {}
    },
    {
        "label": "CAMERA_RESOLUTION_HEIGHT",
        "kind": 5,
        "importPath": "core.live_analyzer",
        "description": "core.live_analyzer",
        "peekOfCode": "CAMERA_RESOLUTION_HEIGHT = getattr(_cfg, \"CAMERA_RESOLUTION_HEIGHT\", 720)\nCAMERA_BUFFER_SIZE       = getattr(_cfg, \"CAMERA_BUFFER_SIZE\", 1)\nFACE_CAM_INDEX  = getattr(_cfg, \"FACE_CAM_INDEX\", 1)  # 預設 0 = Mac 筆電鏡頭\nPLATE_CAM_INDEX = getattr(_cfg, \"PLATE_CAM_INDEX\", 0)  # 預設 1 = 手機鏡頭（Camo 等）\nVLM_INTERVAL_SECONDS = 10.0\nLOG_INTERVAL_SECONDS = 5.0 \nEVIDENCE_DIR = \"session_evidence\" \nclass LiveAnalyzer:\n    def __init__(self, model_pack: dict, menu_items: list, analysis_options: dict, db_manager):\n        self.model_pack = model_pack",
        "detail": "core.live_analyzer",
        "documentation": {}
    },
    {
        "label": "PLATE_CAM_INDEX",
        "kind": 5,
        "importPath": "core.live_analyzer",
        "description": "core.live_analyzer",
        "peekOfCode": "PLATE_CAM_INDEX = getattr(_cfg, \"PLATE_CAM_INDEX\", 0)  # 預設 1 = 手機鏡頭（Camo 等）\nVLM_INTERVAL_SECONDS = 10.0\nLOG_INTERVAL_SECONDS = 5.0 \nEVIDENCE_DIR = \"session_evidence\" \nclass LiveAnalyzer:\n    def __init__(self, model_pack: dict, menu_items: list, analysis_options: dict, db_manager):\n        self.model_pack = model_pack\n        self.menu_items = menu_items\n        self.analysis_options = analysis_options\n        self._face_display_queue = Queue(maxsize=1)",
        "detail": "core.live_analyzer",
        "documentation": {}
    },
    {
        "label": "VLM_INTERVAL_SECONDS",
        "kind": 5,
        "importPath": "core.live_analyzer",
        "description": "core.live_analyzer",
        "peekOfCode": "VLM_INTERVAL_SECONDS = 10.0\nLOG_INTERVAL_SECONDS = 5.0 \nEVIDENCE_DIR = \"session_evidence\" \nclass LiveAnalyzer:\n    def __init__(self, model_pack: dict, menu_items: list, analysis_options: dict, db_manager):\n        self.model_pack = model_pack\n        self.menu_items = menu_items\n        self.analysis_options = analysis_options\n        self._face_display_queue = Queue(maxsize=1)\n        self._face_analysis_queue = Queue(maxsize=1)",
        "detail": "core.live_analyzer",
        "documentation": {}
    },
    {
        "label": "LOG_INTERVAL_SECONDS",
        "kind": 5,
        "importPath": "core.live_analyzer",
        "description": "core.live_analyzer",
        "peekOfCode": "LOG_INTERVAL_SECONDS = 5.0 \nEVIDENCE_DIR = \"session_evidence\" \nclass LiveAnalyzer:\n    def __init__(self, model_pack: dict, menu_items: list, analysis_options: dict, db_manager):\n        self.model_pack = model_pack\n        self.menu_items = menu_items\n        self.analysis_options = analysis_options\n        self._face_display_queue = Queue(maxsize=1)\n        self._face_analysis_queue = Queue(maxsize=1)\n        self._plate_display_queue = Queue(maxsize=1)",
        "detail": "core.live_analyzer",
        "documentation": {}
    },
    {
        "label": "EVIDENCE_DIR",
        "kind": 5,
        "importPath": "core.live_analyzer",
        "description": "core.live_analyzer",
        "peekOfCode": "EVIDENCE_DIR = \"session_evidence\" \nclass LiveAnalyzer:\n    def __init__(self, model_pack: dict, menu_items: list, analysis_options: dict, db_manager):\n        self.model_pack = model_pack\n        self.menu_items = menu_items\n        self.analysis_options = analysis_options\n        self._face_display_queue = Queue(maxsize=1)\n        self._face_analysis_queue = Queue(maxsize=1)\n        self._plate_display_queue = Queue(maxsize=1)\n        self._plate_analysis_queue = Queue(maxsize=1)",
        "detail": "core.live_analyzer",
        "documentation": {}
    },
    {
        "label": "AnalysisResult",
        "kind": 6,
        "importPath": "core.types",
        "description": "core.types",
        "peekOfCode": "class AnalysisResult:\n    def __init__(self):\n        # 既有的欄位\n        self.nod_event = False\n        self.shake_event = False\n        self.emotion_event = None\n        self.plate_event = None\n        # ★★★ 新增這兩個缺少的欄位 ★★★\n        self.plate_insight = None      # 修正 AttributeError\n        self.token_usage_event = None  # 避免未來報錯",
        "detail": "core.types",
        "documentation": {}
    },
    {
        "label": "StatPoint",
        "kind": 6,
        "importPath": "services.analyzer",
        "description": "services.analyzer",
        "peekOfCode": "class StatPoint:\n    ts_bin: int\n    zone: str\n    pos: int\n    neu: int\n    neg: int\n    score_sum: float\n    events: int\nclass EmotionSatisfactionAnalyzer:\n    def __init__(self, rolling_sec:int=ROLLING_SEC):",
        "detail": "services.analyzer",
        "documentation": {}
    },
    {
        "label": "EmotionSatisfactionAnalyzer",
        "kind": 6,
        "importPath": "services.analyzer",
        "description": "services.analyzer",
        "peekOfCode": "class EmotionSatisfactionAnalyzer:\n    def __init__(self, rolling_sec:int=ROLLING_SEC):\n        self.rolling_sec = rolling_sec\n        self.buffer = deque()\n        self.grid = defaultdict(lambda: defaultdict(lambda: StatPoint(0, ZONE_DEFAULT, 0,0,0,0.0,0)))\n    @staticmethod\n    def _bucket(score: float) -> str:\n        if score > 0.2: return \"pos\"\n        if score < -0.2: return \"neg\"\n        return \"neu\"",
        "detail": "services.analyzer",
        "documentation": {}
    },
    {
        "label": "to_bin",
        "kind": 2,
        "importPath": "services.analyzer",
        "description": "services.analyzer",
        "peekOfCode": "def to_bin(ts: float, bin_sec: int = TIME_BIN_SEC) -> int:\n    return int(ts // bin_sec) * bin_sec\n@dataclass\nclass StatPoint:\n    ts_bin: int\n    zone: str\n    pos: int\n    neu: int\n    neg: int\n    score_sum: float",
        "detail": "services.analyzer",
        "documentation": {}
    },
    {
        "label": "ROLLING_SEC",
        "kind": 5,
        "importPath": "services.analyzer",
        "description": "services.analyzer",
        "peekOfCode": "ROLLING_SEC = 60\nTIME_BIN_SEC = 300\nZONE_DEFAULT = \"unknown\"\nEVENT_SCORE = {\n    \"smile\": +1.0,\n    \"nod\": +0.8,\n    \"lean_forward\": +0.3,\n    \"hand_raise\": 0.0,\n    \"neutral\": 0.0,\n    \"shake\": -0.8,",
        "detail": "services.analyzer",
        "documentation": {}
    },
    {
        "label": "TIME_BIN_SEC",
        "kind": 5,
        "importPath": "services.analyzer",
        "description": "services.analyzer",
        "peekOfCode": "TIME_BIN_SEC = 300\nZONE_DEFAULT = \"unknown\"\nEVENT_SCORE = {\n    \"smile\": +1.0,\n    \"nod\": +0.8,\n    \"lean_forward\": +0.3,\n    \"hand_raise\": 0.0,\n    \"neutral\": 0.0,\n    \"shake\": -0.8,\n    \"frown\": -0.8,",
        "detail": "services.analyzer",
        "documentation": {}
    },
    {
        "label": "ZONE_DEFAULT",
        "kind": 5,
        "importPath": "services.analyzer",
        "description": "services.analyzer",
        "peekOfCode": "ZONE_DEFAULT = \"unknown\"\nEVENT_SCORE = {\n    \"smile\": +1.0,\n    \"nod\": +0.8,\n    \"lean_forward\": +0.3,\n    \"hand_raise\": 0.0,\n    \"neutral\": 0.0,\n    \"shake\": -0.8,\n    \"frown\": -0.8,\n    \"lean_back\": -0.3,",
        "detail": "services.analyzer",
        "documentation": {}
    },
    {
        "label": "EVENT_SCORE",
        "kind": 5,
        "importPath": "services.analyzer",
        "description": "services.analyzer",
        "peekOfCode": "EVENT_SCORE = {\n    \"smile\": +1.0,\n    \"nod\": +0.8,\n    \"lean_forward\": +0.3,\n    \"hand_raise\": 0.0,\n    \"neutral\": 0.0,\n    \"shake\": -0.8,\n    \"frown\": -0.8,\n    \"lean_back\": -0.3,\n    \"dislike\": -1.0,",
        "detail": "services.analyzer",
        "documentation": {}
    },
    {
        "label": "DatabaseManager",
        "kind": 6,
        "importPath": "services.database",
        "description": "services.database",
        "peekOfCode": "class DatabaseManager:\n    def __init__(self, db_path=DB_NAME):\n        self.db_path = db_path\n        self.init_db()\n    def get_connection(self):\n        \"\"\"建立並回傳資料庫連線\"\"\"\n        return sqlite3.connect(\n            self.db_path, \n            check_same_thread=False,\n            timeout=10.0",
        "detail": "services.database",
        "documentation": {}
    },
    {
        "label": "save_session",
        "kind": 2,
        "importPath": "services.database",
        "description": "services.database",
        "peekOfCode": "def save_session(raw_session_id, mode, duration, nod, shake, emotion_dict, leftover_dict, insight):\n    return _db_instance.save_session(raw_session_id, mode, duration, nod, shake, emotion_dict, leftover_dict, insight)\ndef insert_log(source_type, people_count, emotions, food_detected):\n    return _db_instance.insert_log(source_type, people_count, emotions, food_detected)\ndef get_customer_groups_analysis(start_time, end_time, gap_minutes=3):\n    return _db_instance.get_customer_groups_analysis(start_time, end_time, gap_minutes)\ndef get_logs_by_range(start_time, end_time, source_types=None):\n    return _db_instance.get_logs_by_range(start_time, end_time, source_types)\ndef get_event_evidence(session_id, event_type=None):\n    return _db_instance.get_event_evidence(session_id, event_type)",
        "detail": "services.database",
        "documentation": {}
    },
    {
        "label": "insert_log",
        "kind": 2,
        "importPath": "services.database",
        "description": "services.database",
        "peekOfCode": "def insert_log(source_type, people_count, emotions, food_detected):\n    return _db_instance.insert_log(source_type, people_count, emotions, food_detected)\ndef get_customer_groups_analysis(start_time, end_time, gap_minutes=3):\n    return _db_instance.get_customer_groups_analysis(start_time, end_time, gap_minutes)\ndef get_logs_by_range(start_time, end_time, source_types=None):\n    return _db_instance.get_logs_by_range(start_time, end_time, source_types)\ndef get_event_evidence(session_id, event_type=None):\n    return _db_instance.get_event_evidence(session_id, event_type)\ndef update_evidence_feedback(evidence_id, is_correct: bool):\n    return _db_instance.update_evidence_feedback(evidence_id, is_correct)",
        "detail": "services.database",
        "documentation": {}
    },
    {
        "label": "get_customer_groups_analysis",
        "kind": 2,
        "importPath": "services.database",
        "description": "services.database",
        "peekOfCode": "def get_customer_groups_analysis(start_time, end_time, gap_minutes=3):\n    return _db_instance.get_customer_groups_analysis(start_time, end_time, gap_minutes)\ndef get_logs_by_range(start_time, end_time, source_types=None):\n    return _db_instance.get_logs_by_range(start_time, end_time, source_types)\ndef get_event_evidence(session_id, event_type=None):\n    return _db_instance.get_event_evidence(session_id, event_type)\ndef update_evidence_feedback(evidence_id, is_correct: bool):\n    return _db_instance.update_evidence_feedback(evidence_id, is_correct)",
        "detail": "services.database",
        "documentation": {}
    },
    {
        "label": "get_logs_by_range",
        "kind": 2,
        "importPath": "services.database",
        "description": "services.database",
        "peekOfCode": "def get_logs_by_range(start_time, end_time, source_types=None):\n    return _db_instance.get_logs_by_range(start_time, end_time, source_types)\ndef get_event_evidence(session_id, event_type=None):\n    return _db_instance.get_event_evidence(session_id, event_type)\ndef update_evidence_feedback(evidence_id, is_correct: bool):\n    return _db_instance.update_evidence_feedback(evidence_id, is_correct)",
        "detail": "services.database",
        "documentation": {}
    },
    {
        "label": "get_event_evidence",
        "kind": 2,
        "importPath": "services.database",
        "description": "services.database",
        "peekOfCode": "def get_event_evidence(session_id, event_type=None):\n    return _db_instance.get_event_evidence(session_id, event_type)\ndef update_evidence_feedback(evidence_id, is_correct: bool):\n    return _db_instance.update_evidence_feedback(evidence_id, is_correct)",
        "detail": "services.database",
        "documentation": {}
    },
    {
        "label": "update_evidence_feedback",
        "kind": 2,
        "importPath": "services.database",
        "description": "services.database",
        "peekOfCode": "def update_evidence_feedback(evidence_id, is_correct: bool):\n    return _db_instance.update_evidence_feedback(evidence_id, is_correct)",
        "detail": "services.database",
        "documentation": {}
    },
    {
        "label": "DB_NAME",
        "kind": 5,
        "importPath": "services.database",
        "description": "services.database",
        "peekOfCode": "DB_NAME = \"dinesence.db\"\nclass DatabaseManager:\n    def __init__(self, db_path=DB_NAME):\n        self.db_path = db_path\n        self.init_db()\n    def get_connection(self):\n        \"\"\"建立並回傳資料庫連線\"\"\"\n        return sqlite3.connect(\n            self.db_path, \n            check_same_thread=False,",
        "detail": "services.database",
        "documentation": {}
    },
    {
        "label": "_db_instance",
        "kind": 5,
        "importPath": "services.database",
        "description": "services.database",
        "peekOfCode": "_db_instance = DatabaseManager()\ndef save_session(raw_session_id, mode, duration, nod, shake, emotion_dict, leftover_dict, insight):\n    return _db_instance.save_session(raw_session_id, mode, duration, nod, shake, emotion_dict, leftover_dict, insight)\ndef insert_log(source_type, people_count, emotions, food_detected):\n    return _db_instance.insert_log(source_type, people_count, emotions, food_detected)\ndef get_customer_groups_analysis(start_time, end_time, gap_minutes=3):\n    return _db_instance.get_customer_groups_analysis(start_time, end_time, gap_minutes)\ndef get_logs_by_range(start_time, end_time, source_types=None):\n    return _db_instance.get_logs_by_range(start_time, end_time, source_types)\ndef get_event_evidence(session_id, event_type=None):",
        "detail": "services.database",
        "documentation": {}
    },
    {
        "label": "BehaviorEvent",
        "kind": 6,
        "importPath": "services.detectors",
        "description": "services.detectors",
        "peekOfCode": "class BehaviorEvent:\n    ts: float\n    event_type: str\n    subject_id: Optional[int]\n    zone: Optional[str]\n    score: Optional[float]\n    meta: Optional[Dict[str, Any]] = None\n# --------------------------------------------------\n#  New: Unified Head Gesture Detector\n# --------------------------------------------------",
        "detail": "services.detectors",
        "documentation": {}
    },
    {
        "label": "HeadGestureDetector",
        "kind": 6,
        "importPath": "services.detectors",
        "description": "services.detectors",
        "peekOfCode": "class HeadGestureDetector:\n    \"\"\"\n    嚴格版頭部動作偵測 (取代原本分開的 Nod/Shake 偵測器)\n    同時監控 X 與 Y 軸，確保動作單純才觸發。\n    \"\"\"\n    def __init__(\n        self,\n        buf_len=GESTURE_BUFFER_LEN,\n        nod_amp_thresh=NOD_AMP_THRESH,\n        shake_amp_thresh=SHAKE_AMP_THRESH,",
        "detail": "services.detectors",
        "documentation": {}
    },
    {
        "label": "PostureClassifier",
        "kind": 6,
        "importPath": "services.detectors",
        "description": "services.detectors",
        "peekOfCode": "class PostureClassifier:\n    def __init__(self, fwd_deg:float=LEAN_FWD_TORSO_DEG, back_deg:float=LEAN_BACK_TORSO_DEG):\n        self.fwd_deg = fwd_deg\n        self.back_deg = back_deg\n    @staticmethod\n    def _deg(a, b):\n        a = np.array(a, dtype=np.float32); b = np.array(b, dtype=np.float32)\n        dot = float(np.dot(a,b)); na = np.linalg.norm(a); nb = np.linalg.norm(b)\n        if na == 0 or nb == 0: return 0.0\n        cosv = np.clip(dot/(na*nb), -1.0, 1.0)",
        "detail": "services.detectors",
        "documentation": {}
    },
    {
        "label": "HandRaiseDetector",
        "kind": 6,
        "importPath": "services.detectors",
        "description": "services.detectors",
        "peekOfCode": "class HandRaiseDetector:\n    # 這裡現在可以正確抓到全域的 COOLDOWN_SECONDS 了\n    def __init__(self, margin:int=HAND_RAISE_MARGIN, cooldown:float=COOLDOWN_SECONDS):\n        self.margin = margin\n        self.last_ts = 0.0\n        self.cooldown = cooldown\n    def update_and_check(self, landmarks, img_h:int, img_w:int):\n        LWR, RWR, LSH, RSH = 15,16,11,12\n        try:\n            lw_y = landmarks[LWR].y * img_h; rw_y = landmarks[RWR].y * img_h",
        "detail": "services.detectors",
        "documentation": {}
    },
    {
        "label": "ExpressionEstimator",
        "kind": 6,
        "importPath": "services.detectors",
        "description": "services.detectors",
        "peekOfCode": "class ExpressionEstimator:\n    def __init__(self, external_clf=None, use_heuristic:bool=True):\n        self.external = external_clf; self.use_heur = use_heuristic\n    def predict(self, face_bgr, facemesh_landmarks=None):\n        if self.external is not None:\n            return self.external.predict(face_bgr)\n        # fallback heuristic\n        return {\"label\":\"neutral\",\"score\":0.5}\n# --------------------------------------------------\n#  Main Aggregator Class",
        "detail": "services.detectors",
        "documentation": {}
    },
    {
        "label": "BodyEmotionDetector",
        "kind": 6,
        "importPath": "services.detectors",
        "description": "services.detectors",
        "peekOfCode": "class BodyEmotionDetector:\n    def __init__(self):\n        # [Updated] Use the single HeadGestureDetector instead of separate ones\n        self.head_gesture = HeadGestureDetector()\n        self.posture = PostureClassifier()\n        self.hand_raise = HandRaiseDetector()\n        self.expr = ExpressionEstimator()\n    def process_frame(self, frame_bgr, *, face_detector, pose_landmarks=None,\n                      nose_xy: Optional[Tuple[float,float]]=None, ears_xy: Optional[Tuple[Tuple[float,float],Tuple[float,float]]]=None,\n                      zone: Optional[str]=None, face_mesh_points: Optional[dict]=None, subject_id: Optional[int]=None):",
        "detail": "services.detectors",
        "documentation": {}
    },
    {
        "label": "crop_face_with_mediapipe",
        "kind": 2,
        "importPath": "services.detectors",
        "description": "services.detectors",
        "peekOfCode": "def crop_face_with_mediapipe(bgr_frame, detector, min_conf:float=MIN_FACE_CONF):\n    rgb = cv2.cvtColor(bgr_frame, cv2.COLOR_BGR2RGB)\n    res = detector.process(rgb)\n    if not res.detections:\n        return None, None\n    det = res.detections[0]\n    score = det.score[0] if hasattr(det, \"score\") else getattr(det, \"confidence\", 0.0)\n    if score < min_conf:\n        return None, None\n    h, w = bgr_frame.shape[:2]",
        "detail": "services.detectors",
        "documentation": {}
    },
    {
        "label": "COOLDOWN_SECONDS",
        "kind": 5,
        "importPath": "services.detectors",
        "description": "services.detectors",
        "peekOfCode": "COOLDOWN_SECONDS = 0.8        # 原本 1.0 -> 改短一點，測試比較方便\n# 頭部動作偵測參數\nGESTURE_BUFFER_LEN = 20\n# ★★★ 關鍵修改區 ★★★\nNOD_AMP_THRESH = 0.008        # 原本 0.015 -> 改 0.008 (讓小幅度點頭也能觸發)\nSHAKE_AMP_THRESH = 0.010      # 原本 0.020 -> 改 0.010\nMAX_SECONDARY_AMP = 0.020     # 原本 0.010 -> 改 0.020 (這是重點！容許頭部不自覺的左右晃動)\nMIN_OSC_COUNT = 2             # 原本 3 -> 改 2 (來回一次就觸發)\nGESTURE_COOLDOWN = 0.8\nGESTURE_MIN_OFFSET = 0.002",
        "detail": "services.detectors",
        "documentation": {}
    },
    {
        "label": "GESTURE_BUFFER_LEN",
        "kind": 5,
        "importPath": "services.detectors",
        "description": "services.detectors",
        "peekOfCode": "GESTURE_BUFFER_LEN = 20\n# ★★★ 關鍵修改區 ★★★\nNOD_AMP_THRESH = 0.008        # 原本 0.015 -> 改 0.008 (讓小幅度點頭也能觸發)\nSHAKE_AMP_THRESH = 0.010      # 原本 0.020 -> 改 0.010\nMAX_SECONDARY_AMP = 0.020     # 原本 0.010 -> 改 0.020 (這是重點！容許頭部不自覺的左右晃動)\nMIN_OSC_COUNT = 2             # 原本 3 -> 改 2 (來回一次就觸發)\nGESTURE_COOLDOWN = 0.8\nGESTURE_MIN_OFFSET = 0.002\n# 其他偵測參數\nHAND_RAISE_MARGIN = 30",
        "detail": "services.detectors",
        "documentation": {}
    },
    {
        "label": "NOD_AMP_THRESH",
        "kind": 5,
        "importPath": "services.detectors",
        "description": "services.detectors",
        "peekOfCode": "NOD_AMP_THRESH = 0.008        # 原本 0.015 -> 改 0.008 (讓小幅度點頭也能觸發)\nSHAKE_AMP_THRESH = 0.010      # 原本 0.020 -> 改 0.010\nMAX_SECONDARY_AMP = 0.020     # 原本 0.010 -> 改 0.020 (這是重點！容許頭部不自覺的左右晃動)\nMIN_OSC_COUNT = 2             # 原本 3 -> 改 2 (來回一次就觸發)\nGESTURE_COOLDOWN = 0.8\nGESTURE_MIN_OFFSET = 0.002\n# 其他偵測參數\nHAND_RAISE_MARGIN = 30\nLEAN_FWD_TORSO_DEG = 12\nLEAN_BACK_TORSO_DEG = -8",
        "detail": "services.detectors",
        "documentation": {}
    },
    {
        "label": "SHAKE_AMP_THRESH",
        "kind": 5,
        "importPath": "services.detectors",
        "description": "services.detectors",
        "peekOfCode": "SHAKE_AMP_THRESH = 0.010      # 原本 0.020 -> 改 0.010\nMAX_SECONDARY_AMP = 0.020     # 原本 0.010 -> 改 0.020 (這是重點！容許頭部不自覺的左右晃動)\nMIN_OSC_COUNT = 2             # 原本 3 -> 改 2 (來回一次就觸發)\nGESTURE_COOLDOWN = 0.8\nGESTURE_MIN_OFFSET = 0.002\n# 其他偵測參數\nHAND_RAISE_MARGIN = 30\nLEAN_FWD_TORSO_DEG = 12\nLEAN_BACK_TORSO_DEG = -8\nMIN_FACE_CONF = 0.6",
        "detail": "services.detectors",
        "documentation": {}
    },
    {
        "label": "MAX_SECONDARY_AMP",
        "kind": 5,
        "importPath": "services.detectors",
        "description": "services.detectors",
        "peekOfCode": "MAX_SECONDARY_AMP = 0.020     # 原本 0.010 -> 改 0.020 (這是重點！容許頭部不自覺的左右晃動)\nMIN_OSC_COUNT = 2             # 原本 3 -> 改 2 (來回一次就觸發)\nGESTURE_COOLDOWN = 0.8\nGESTURE_MIN_OFFSET = 0.002\n# 其他偵測參數\nHAND_RAISE_MARGIN = 30\nLEAN_FWD_TORSO_DEG = 12\nLEAN_BACK_TORSO_DEG = -8\nMIN_FACE_CONF = 0.6\n@dataclass",
        "detail": "services.detectors",
        "documentation": {}
    },
    {
        "label": "MIN_OSC_COUNT",
        "kind": 5,
        "importPath": "services.detectors",
        "description": "services.detectors",
        "peekOfCode": "MIN_OSC_COUNT = 2             # 原本 3 -> 改 2 (來回一次就觸發)\nGESTURE_COOLDOWN = 0.8\nGESTURE_MIN_OFFSET = 0.002\n# 其他偵測參數\nHAND_RAISE_MARGIN = 30\nLEAN_FWD_TORSO_DEG = 12\nLEAN_BACK_TORSO_DEG = -8\nMIN_FACE_CONF = 0.6\n@dataclass\nclass BehaviorEvent:",
        "detail": "services.detectors",
        "documentation": {}
    },
    {
        "label": "GESTURE_COOLDOWN",
        "kind": 5,
        "importPath": "services.detectors",
        "description": "services.detectors",
        "peekOfCode": "GESTURE_COOLDOWN = 0.8\nGESTURE_MIN_OFFSET = 0.002\n# 其他偵測參數\nHAND_RAISE_MARGIN = 30\nLEAN_FWD_TORSO_DEG = 12\nLEAN_BACK_TORSO_DEG = -8\nMIN_FACE_CONF = 0.6\n@dataclass\nclass BehaviorEvent:\n    ts: float",
        "detail": "services.detectors",
        "documentation": {}
    },
    {
        "label": "GESTURE_MIN_OFFSET",
        "kind": 5,
        "importPath": "services.detectors",
        "description": "services.detectors",
        "peekOfCode": "GESTURE_MIN_OFFSET = 0.002\n# 其他偵測參數\nHAND_RAISE_MARGIN = 30\nLEAN_FWD_TORSO_DEG = 12\nLEAN_BACK_TORSO_DEG = -8\nMIN_FACE_CONF = 0.6\n@dataclass\nclass BehaviorEvent:\n    ts: float\n    event_type: str",
        "detail": "services.detectors",
        "documentation": {}
    },
    {
        "label": "HAND_RAISE_MARGIN",
        "kind": 5,
        "importPath": "services.detectors",
        "description": "services.detectors",
        "peekOfCode": "HAND_RAISE_MARGIN = 30\nLEAN_FWD_TORSO_DEG = 12\nLEAN_BACK_TORSO_DEG = -8\nMIN_FACE_CONF = 0.6\n@dataclass\nclass BehaviorEvent:\n    ts: float\n    event_type: str\n    subject_id: Optional[int]\n    zone: Optional[str]",
        "detail": "services.detectors",
        "documentation": {}
    },
    {
        "label": "LEAN_FWD_TORSO_DEG",
        "kind": 5,
        "importPath": "services.detectors",
        "description": "services.detectors",
        "peekOfCode": "LEAN_FWD_TORSO_DEG = 12\nLEAN_BACK_TORSO_DEG = -8\nMIN_FACE_CONF = 0.6\n@dataclass\nclass BehaviorEvent:\n    ts: float\n    event_type: str\n    subject_id: Optional[int]\n    zone: Optional[str]\n    score: Optional[float]",
        "detail": "services.detectors",
        "documentation": {}
    },
    {
        "label": "LEAN_BACK_TORSO_DEG",
        "kind": 5,
        "importPath": "services.detectors",
        "description": "services.detectors",
        "peekOfCode": "LEAN_BACK_TORSO_DEG = -8\nMIN_FACE_CONF = 0.6\n@dataclass\nclass BehaviorEvent:\n    ts: float\n    event_type: str\n    subject_id: Optional[int]\n    zone: Optional[str]\n    score: Optional[float]\n    meta: Optional[Dict[str, Any]] = None",
        "detail": "services.detectors",
        "documentation": {}
    },
    {
        "label": "MIN_FACE_CONF",
        "kind": 5,
        "importPath": "services.detectors",
        "description": "services.detectors",
        "peekOfCode": "MIN_FACE_CONF = 0.6\n@dataclass\nclass BehaviorEvent:\n    ts: float\n    event_type: str\n    subject_id: Optional[int]\n    zone: Optional[str]\n    score: Optional[float]\n    meta: Optional[Dict[str, Any]] = None\n# --------------------------------------------------",
        "detail": "services.detectors",
        "documentation": {}
    },
    {
        "label": "get_openai_client",
        "kind": 2,
        "importPath": "services.llm_handler",
        "description": "services.llm_handler",
        "peekOfCode": "def get_openai_client(api_key):\n    \"\"\"根據 API Key 初始化並返回異步的 OpenAI 客戶端物件。\"\"\"\n    if not api_key:\n        return None\n    try:\n        return AsyncOpenAI(api_key=api_key)\n    except Exception as e:\n        print(f\"初始化 OpenAI Client 失敗: {e}\")\n        return None\ndef _image_to_base64(pil_image: Image.Image) -> str:",
        "detail": "services.llm_handler",
        "documentation": {}
    },
    {
        "label": "aclient",
        "kind": 5,
        "importPath": "services.llm_handler",
        "description": "services.llm_handler",
        "peekOfCode": "aclient = httpx.AsyncClient()\n# 圖片最大邊長限制\nMAX_VLM_IMAGE_DIM = 768\ndef get_openai_client(api_key):\n    \"\"\"根據 API Key 初始化並返回異步的 OpenAI 客戶端物件。\"\"\"\n    if not api_key:\n        return None\n    try:\n        return AsyncOpenAI(api_key=api_key)\n    except Exception as e:",
        "detail": "services.llm_handler",
        "documentation": {}
    },
    {
        "label": "MAX_VLM_IMAGE_DIM",
        "kind": 5,
        "importPath": "services.llm_handler",
        "description": "services.llm_handler",
        "peekOfCode": "MAX_VLM_IMAGE_DIM = 768\ndef get_openai_client(api_key):\n    \"\"\"根據 API Key 初始化並返回異步的 OpenAI 客戶端物件。\"\"\"\n    if not api_key:\n        return None\n    try:\n        return AsyncOpenAI(api_key=api_key)\n    except Exception as e:\n        print(f\"初始化 OpenAI Client 失敗: {e}\")\n        return None",
        "detail": "services.llm_handler",
        "documentation": {}
    },
    {
        "label": "HeadGestureDetectorStrict",
        "kind": 6,
        "importPath": "services.nod_test",
        "description": "services.nod_test",
        "peekOfCode": "class HeadGestureDetectorStrict:\n    \"\"\"\n    嚴格版頭部動作偵測：\n    - 同時看 X / Y 相對位移的波形\n    - 點頭：Y 振幅夠大，而且 X 幾乎沒動\n    - 搖頭：X 振幅夠大，而且 Y 幾乎沒動\n    - 只要兩邊一起動得很大，就當「模糊動作」→ 不判\n    \"\"\"\n    def __init__(\n        self,",
        "detail": "services.nod_test",
        "documentation": {}
    },
    {
        "label": "main",
        "kind": 2,
        "importPath": "services.nod_test",
        "description": "services.nod_test",
        "peekOfCode": "def main():\n    mp_pose = mp.solutions.pose\n    pose = mp_pose.Pose(\n        model_complexity=0,\n        enable_segmentation=False,\n        min_detection_confidence=0.5,\n        min_tracking_confidence=0.5,\n    )\n    cap = cv2.VideoCapture(0)\n    if not cap.isOpened():",
        "detail": "services.nod_test",
        "documentation": {}
    },
    {
        "label": "HeadGestureDetector",
        "kind": 6,
        "importPath": "services.vision_analysis",
        "description": "services.vision_analysis",
        "peekOfCode": "class HeadGestureDetector:\n    \"\"\"\n    嚴格版頭部動作偵測：\n    - 同時看 X / Y 相對位移的波形\n    - 點頭：Y 振幅夠大，而且 X 幾乎沒動\n    - 搖頭：X 振幅夠大，而且 Y 幾乎沒動\n    \"\"\"\n    def __init__(\n        self,\n        buf_len=GESTURE_BUFFER_LEN,",
        "detail": "services.vision_analysis",
        "documentation": {}
    },
    {
        "label": "get_pose_detector",
        "kind": 2,
        "importPath": "services.vision_analysis",
        "description": "services.vision_analysis",
        "peekOfCode": "def get_pose_detector():\n    return mp_pose.Pose(\n        model_complexity=0,\n        enable_segmentation=False,\n        min_detection_confidence=0.5,\n        min_tracking_confidence=0.5,\n    )\ndef get_face_detector():\n    return mp_face.FaceDetection(\n        model_selection=0,",
        "detail": "services.vision_analysis",
        "documentation": {}
    },
    {
        "label": "get_face_detector",
        "kind": 2,
        "importPath": "services.vision_analysis",
        "description": "services.vision_analysis",
        "peekOfCode": "def get_face_detector():\n    return mp_face.FaceDetection(\n        model_selection=0,\n        min_detection_confidence=0.5\n    )\n# --------------------------------------------------\n#  (A) 餐盤殘留偵測\n# --------------------------------------------------\ndef estimate_plate_leftover(bgr_frame):\n    gray = cv2.cvtColor(bgr_frame, cv2.COLOR_BGR2GRAY)",
        "detail": "services.vision_analysis",
        "documentation": {}
    },
    {
        "label": "estimate_plate_leftover",
        "kind": 2,
        "importPath": "services.vision_analysis",
        "description": "services.vision_analysis",
        "peekOfCode": "def estimate_plate_leftover(bgr_frame):\n    gray = cv2.cvtColor(bgr_frame, cv2.COLOR_BGR2GRAY)\n    gray = cv2.GaussianBlur(gray, (9, 9), 2)\n    circles = cv2.HoughCircles(\n        gray, cv2.HOUGH_GRADIENT, dp=1.2, minDist=120,\n        param1=100, param2=30, minRadius=60, maxRadius=0\n    )\n    if circles is None:\n        return \"未偵測到餐盤\", None, None\n    circles = np.round(circles[0, :]).astype(\"int\")",
        "detail": "services.vision_analysis",
        "documentation": {}
    },
    {
        "label": "crop_face_with_mediapipe",
        "kind": 2,
        "importPath": "services.vision_analysis",
        "description": "services.vision_analysis",
        "peekOfCode": "def crop_face_with_mediapipe(bgr_frame, detector, min_conf=0.6):\n    rgb = cv2.cvtColor(bgr_frame, cv2.COLOR_BGR2RGB)\n    res = detector.process(rgb)\n    if not res.detections:\n        return None\n    det = res.detections[0]\n    if det.score[0] < min_conf:\n        return None\n    h, w = bgr_frame.shape[:2]\n    bbox = det.location_data.relative_bounding_box",
        "detail": "services.vision_analysis",
        "documentation": {}
    },
    {
        "label": "detect_food_regions_yolo",
        "kind": 2,
        "importPath": "services.vision_analysis",
        "description": "services.vision_analysis",
        "peekOfCode": "def detect_food_regions_yolo(bgr, conf=0.3, min_area_ratio=0.01):\n    if not _yolo_ok:\n        return []\n    res = _yolo_food(bgr, conf=conf, iou=0.45, verbose=False)[0]\n    h, w = bgr.shape[:2]\n    out = []\n    for b in res.boxes:\n        name = res.names.get(int(b.cls.item()), \"\")\n        if name not in FOODISH_CLASSES:\n            continue",
        "detail": "services.vision_analysis",
        "documentation": {}
    },
    {
        "label": "has_big_cup",
        "kind": 2,
        "importPath": "services.vision_analysis",
        "description": "services.vision_analysis",
        "peekOfCode": "def has_big_cup(bgr, min_area_ratio=0.04):\n    if not _yolo_ok:\n        return False\n    res = _yolo_food(bgr, conf=0.3, iou=0.45, verbose=False)[0]\n    h, w = bgr.shape[:2]\n    for b in res.boxes:\n        name = res.names.get(int(b.cls.item()), \"\")\n        if name in [\"cup\", \"wine glass\", \"bottle\"]:\n            x1, y1, x2, y2 = map(int, b.xyxy[0].tolist())\n            if ((x2 - x1) * (y2 - y1)) / (w * h) >= min_area_ratio:",
        "detail": "services.vision_analysis",
        "documentation": {}
    },
    {
        "label": "GESTURE_BUFFER_LEN",
        "kind": 5,
        "importPath": "services.vision_analysis",
        "description": "services.vision_analysis",
        "peekOfCode": "GESTURE_BUFFER_LEN = getattr(_cfg, \"GESTURE_BUFFER_LEN\", 20)\nGESTURE_COOLDOWN   = getattr(_cfg, \"GESTURE_COOLDOWN_SECONDS\", 0.8)\nGESTURE_MIN_OFFSET = getattr(_cfg, \"GESTURE_MIN_OFFSET\", 0.002)\n# ★★★ 這裡直接改寬鬆，不用怕 config 沒設對 ★★★\nNOD_AMP_THRESH     = getattr(_cfg, \"NOD_AMP_THRESH\", 0.008)       # 很容易觸發\nSHAKE_AMP_THRESH   = getattr(_cfg, \"SHAKE_AMP_THRESH\", 0.010)\nMAX_SECONDARY_AMP  = getattr(_cfg, \"MAX_SECONDARY_AMP\", 0.020)    # 容許頭晃動\nMIN_OSC_COUNT      = getattr(_cfg, \"MIN_OSC_COUNT\", 2)            # 來回兩次就算\nMIN_FACE_CONF = getattr(_cfg, \"MIN_FACE_CONF\", 0.6)\n# --------------------------------------------------",
        "detail": "services.vision_analysis",
        "documentation": {}
    },
    {
        "label": "GESTURE_MIN_OFFSET",
        "kind": 5,
        "importPath": "services.vision_analysis",
        "description": "services.vision_analysis",
        "peekOfCode": "GESTURE_MIN_OFFSET = getattr(_cfg, \"GESTURE_MIN_OFFSET\", 0.002)\n# ★★★ 這裡直接改寬鬆，不用怕 config 沒設對 ★★★\nNOD_AMP_THRESH     = getattr(_cfg, \"NOD_AMP_THRESH\", 0.008)       # 很容易觸發\nSHAKE_AMP_THRESH   = getattr(_cfg, \"SHAKE_AMP_THRESH\", 0.010)\nMAX_SECONDARY_AMP  = getattr(_cfg, \"MAX_SECONDARY_AMP\", 0.020)    # 容許頭晃動\nMIN_OSC_COUNT      = getattr(_cfg, \"MIN_OSC_COUNT\", 2)            # 來回兩次就算\nMIN_FACE_CONF = getattr(_cfg, \"MIN_FACE_CONF\", 0.6)\n# --------------------------------------------------\n#  模型初始化\n# --------------------------------------------------",
        "detail": "services.vision_analysis",
        "documentation": {}
    },
    {
        "label": "MIN_FACE_CONF",
        "kind": 5,
        "importPath": "services.vision_analysis",
        "description": "services.vision_analysis",
        "peekOfCode": "MIN_FACE_CONF = getattr(_cfg, \"MIN_FACE_CONF\", 0.6)\n# --------------------------------------------------\n#  模型初始化\n# --------------------------------------------------\ntry:\n    _yolo_food = YOLO(YOLO_MODEL_PATH)\n    _yolo_ok = True\nexcept Exception as e:\n    print(f\"[YOLO 載入失敗] {e}\")\n    _yolo_food = None",
        "detail": "services.vision_analysis",
        "documentation": {}
    },
    {
        "label": "mp_pose",
        "kind": 5,
        "importPath": "services.vision_analysis",
        "description": "services.vision_analysis",
        "peekOfCode": "mp_pose = mp.solutions.pose\nmp_face = mp.solutions.face_detection\ndef get_pose_detector():\n    return mp_pose.Pose(\n        model_complexity=0,\n        enable_segmentation=False,\n        min_detection_confidence=0.5,\n        min_tracking_confidence=0.5,\n    )\ndef get_face_detector():",
        "detail": "services.vision_analysis",
        "documentation": {}
    },
    {
        "label": "mp_face",
        "kind": 5,
        "importPath": "services.vision_analysis",
        "description": "services.vision_analysis",
        "peekOfCode": "mp_face = mp.solutions.face_detection\ndef get_pose_detector():\n    return mp_pose.Pose(\n        model_complexity=0,\n        enable_segmentation=False,\n        min_detection_confidence=0.5,\n        min_tracking_confidence=0.5,\n    )\ndef get_face_detector():\n    return mp_face.FaceDetection(",
        "detail": "services.vision_analysis",
        "documentation": {}
    },
    {
        "label": "display",
        "kind": 2,
        "importPath": "ui.dashboard_view",
        "description": "ui.dashboard_view",
        "peekOfCode": "def display(client, db_manager, t=None): \n    if t is None: \n        def t(k): return k\n    db = db_manager \n    col_title, col_refresh = st.columns([5, 1])\n    with col_title:\n        st.subheader(t(\"dash_title\"))\n    with col_refresh:\n        if st.button(t(\"btn_refresh\"), use_container_width=True):\n            st.rerun()",
        "detail": "ui.dashboard_view",
        "documentation": {}
    },
    {
        "label": "EVIDENCE_DIR",
        "kind": 5,
        "importPath": "ui.dashboard_view",
        "description": "ui.dashboard_view",
        "peekOfCode": "EVIDENCE_DIR = \"session_evidence\"\n# 輔助函式：圖片 Grid\ndef _render_evidence_grid(db_manager, session_id, event_type):\n    \"\"\"\n    負責讀取並顯示圖片 Grid，不包含外層的 Expander。\n    \"\"\"\n    evidence_df = db_manager.get_event_evidence(session_id, event_type)\n    if evidence_df.empty:\n        st.info(\"NO EVIDENCE FOUND.\", icon=\"ℹ️\")\n        return",
        "detail": "ui.dashboard_view",
        "documentation": {}
    },
    {
        "label": "display",
        "kind": 2,
        "importPath": "ui.live_view",
        "description": "ui.live_view",
        "peekOfCode": "def display(model_pack: dict, backend_config: dict, db_manager, t=None):\n    \"\"\"\n    Live 監控介面 - 雙鏡頭戰情室 (Dual Camera Command Center)\n    \"\"\"\n    if t is None:\n        def t(k): return k\n    # --- 1. Session State 初始化 ---\n    if \"current_raw_session_id\" not in st.session_state:\n        st.session_state.current_raw_session_id = datetime.now().strftime(\"%Y%m%d%H%M%S\")\n    if \"live_toggle_last_state\" not in st.session_state:",
        "detail": "ui.live_view",
        "documentation": {}
    },
    {
        "label": "display",
        "kind": 2,
        "importPath": "ui.login_view",
        "description": "ui.login_view",
        "peekOfCode": "def display():\n    \"\"\"\n    顯示登入頁面並處理驗證邏輯。\n    \"\"\"\n    lcol, ccol, rcol = st.columns([1, 0.8, 1])\n    with ccol:\n        st.write(\"\") \n        st.write(\"\") \n        # 使用容器創造毛玻璃卡片\n        with st.container(border=True):",
        "detail": "ui.login_view",
        "documentation": {}
    },
    {
        "label": "draw_debug_info",
        "kind": 2,
        "importPath": "ui.video_view",
        "description": "ui.video_view",
        "peekOfCode": "def draw_debug_info(frame, face_res, food_res, plate_info):\n    debug_frame = frame.copy()\n    if face_res and face_res.detections:\n        for detection in face_res.detections:\n            bbox = detection.location_data.relative_bounding_box\n            h, w, c = debug_frame.shape\n            x = int(bbox.xmin * w); y = int(bbox.ymin * h)\n            rw = int(bbox.width * w); rh = int(bbox.height * h)\n            cv2.rectangle(debug_frame, (x, y), (x + rw, y + rh), (0, 0, 255), 2)\n            cv2.putText(debug_frame, \"Face\", (x, y - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 0, 255), 2)",
        "detail": "ui.video_view",
        "documentation": {}
    },
    {
        "label": "display",
        "kind": 2,
        "importPath": "ui.video_view",
        "description": "ui.video_view",
        "peekOfCode": "def display(client, menu_items, llm_preferences, t=None):\n    # 防呆：如果沒傳 t，給個預設函式 (雖然理論上 app.py 會傳)\n    if t is None: \n        def t(k): return k\n    st.subheader(t(\"video_header\"))\n    up = st.file_uploader(t(\"video_upload_label\"), type=[\"mp4\", \"avi\"])\n    # --- 設定區 ---\n    with st.container(border=True):\n        col1, col2, col3 = st.columns(3)\n        with col1:",
        "detail": "ui.video_view",
        "documentation": {}
    },
    {
        "label": "get_text",
        "kind": 2,
        "importPath": "utils.localization",
        "description": "utils.localization",
        "peekOfCode": "def get_text(key, lang=\"zh\"):\n    return TRANSLATIONS.get(lang, TRANSLATIONS[\"zh\"]).get(key, key)",
        "detail": "utils.localization",
        "documentation": {}
    },
    {
        "label": "TRANSLATIONS",
        "kind": 5,
        "importPath": "utils.localization",
        "description": "utils.localization",
        "peekOfCode": "TRANSLATIONS = {\n    \"zh\": {\n        # 通用\n        \"app_title\": \"DineSence智慧餐飲分析\",\n        \"settings\": \"系統設定\",\n        \"select_lang\": \" \",\n        # Tabs\n        \"tab_live\": \"🌟 現場監控 (Live)\",\n        \"tab_video\": \"🎞️ 影像分析 (Video)\",\n        \"tab_dashboard\": \"📈 營運儀表板 (Dashboard)\",",
        "detail": "utils.localization",
        "documentation": {}
    },
    {
        "label": "load_prompt_template",
        "kind": 2,
        "importPath": "utils.prompt_loader",
        "description": "utils.prompt_loader",
        "peekOfCode": "def load_prompt_template(feature_name: str, prompt_type: str = \"user\") -> str:\n    \"\"\"\n    從 prompts 資料夾載入指定的 prompt 模板。\n    Args:\n        feature_name (str): 功能名稱 (對應到資料夾名稱，例如 'summarize_session')\n        prompt_type (str): 'user' 或 'system'\n    Returns:\n        str: 讀取到的 prompt 文字內容\n    \"\"\"\n    file_path = os.path.join(PROMPTS_DIR, feature_name, f\"{prompt_type}.txt\")",
        "detail": "utils.prompt_loader",
        "documentation": {}
    },
    {
        "label": "PROMPTS_DIR",
        "kind": 5,
        "importPath": "utils.prompt_loader",
        "description": "utils.prompt_loader",
        "peekOfCode": "PROMPTS_DIR = os.path.join(os.path.dirname(os.path.abspath(__file__)), '..', 'prompts')\n@lru_cache(maxsize=32) # 快取讀取過的 prompt，避免重複讀取檔案\ndef load_prompt_template(feature_name: str, prompt_type: str = \"user\") -> str:\n    \"\"\"\n    從 prompts 資料夾載入指定的 prompt 模板。\n    Args:\n        feature_name (str): 功能名稱 (對應到資料夾名稱，例如 'summarize_session')\n        prompt_type (str): 'user' 或 'system'\n    Returns:\n        str: 讀取到的 prompt 文字內容",
        "detail": "utils.prompt_loader",
        "documentation": {}
    },
    {
        "label": "initialize_state",
        "kind": 2,
        "importPath": "utils.state_manager",
        "description": "utils.state_manager",
        "peekOfCode": "def initialize_state():\n    \"\"\"\n    初始化應用程式所有分頁都會用到的 session_state。\n    此函式應在主程式 app.py 的最開始被呼叫一次。\n    \"\"\"\n    states = {\n        # --- 登入與核心物件 ---\n        \"auth\": False,\n        \"analyzer\": None,  # 用於存放 LiveAnalyzer 引擎的實例\n        # --- [新增] Session 歷史紀錄相關狀態 ---",
        "detail": "utils.state_manager",
        "documentation": {}
    },
    {
        "label": "load_custom_css",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def load_custom_css():\n    st.markdown(\"\"\"\n    <style>\n        /* 1. 引用字體 */\n        @import url('https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;600;700&family=Noto+Sans+TC:wght@400;500;700&display=swap');\n        /* 2. 全局設定 - 讓 Streamlit 使用 config.toml 的設定 */\n        html, body, [class*=\"css\"] {\n            font-family: 'Noto Sans TC', sans-serif;\n            /* 移除強制背景色，讓 config.toml 生效 */\n        }",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "t",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def t(key):\n    return localization.get_text(key, st.session_state['language'])\n# --- 4. 初始化資源 ---\n@st.cache_resource\ndef load_models():\n    db_manager = DatabaseManager() \n    openai_client = llm_handler.get_openai_client(config.OPENAI_API_KEY)\n    pose_detector = va.get_pose_detector()\n    face_detector = va.get_face_detector()\n    _ = va.get_food_model() if hasattr(va, 'get_food_model') else None",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "load_models",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def load_models():\n    db_manager = DatabaseManager() \n    openai_client = llm_handler.get_openai_client(config.OPENAI_API_KEY)\n    pose_detector = va.get_pose_detector()\n    face_detector = va.get_face_detector()\n    _ = va.get_food_model() if hasattr(va, 'get_food_model') else None\n    body_emotion_detector = BodyEmotionDetector()\n    emotion_analyzer = EmotionSatisfactionAnalyzer()\n    return openai_client, pose_detector, face_detector, body_emotion_detector, emotion_analyzer, db_manager\nclient, pose_detector, face_detector, body_emotion_detector, emotion_analyzer, db_manager = load_models()",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "BACKEND_CONFIG",
        "kind": 5,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "BACKEND_CONFIG = {\n    \"store_type\": \"Buffet\", \n    \"menu_items\": [\"Main Course\", \"Vegetables\", \"Dessert\", \"Drinks\"] \n}\nmodel_pack = {\n    \"client\": client,\n    \"pose_detector\": pose_detector,\n    \"face_detector\": face_detector\n}\n# --- 7. 主頁面 UI ---",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "model_pack",
        "kind": 5,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "model_pack = {\n    \"client\": client,\n    \"pose_detector\": pose_detector,\n    \"face_detector\": face_detector\n}\n# --- 7. 主頁面 UI ---\ntop_col1, top_col2 = st.columns([6, 1])\nwith top_col1:\n    # 標題這裡也讓它使用主色\n    st.markdown(f\"<h1>DineSence <span style='color:var(--primary-color); text-shadow:0 0 15px var(--primary-color);'></span> <span style='font-size:0.5em; opacity:0.7;'>// {t('live_panel_title')}</span></h1>\", unsafe_allow_html=True)",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "DASH_USER",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "DASH_USER = \"admin\"\nDASH_PASS = \"1234\"\nOPENAI_API_KEY = os.getenv(\"OPENAI_API_KEY\")\n# ---------------------\n# LLM Setting\n# ---------------------\nLLM_MODEL_EMOTION = \"gpt-4o-mini\"\nLLM_MODEL_SUMMARY = \"gpt-4o-mini\"\n# ---------------------\n# Camera Setting",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "DASH_PASS",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "DASH_PASS = \"1234\"\nOPENAI_API_KEY = os.getenv(\"OPENAI_API_KEY\")\n# ---------------------\n# LLM Setting\n# ---------------------\nLLM_MODEL_EMOTION = \"gpt-4o-mini\"\nLLM_MODEL_SUMMARY = \"gpt-4o-mini\"\n# ---------------------\n# Camera Setting\n# ---------------------",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "OPENAI_API_KEY",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "OPENAI_API_KEY = os.getenv(\"OPENAI_API_KEY\")\n# ---------------------\n# LLM Setting\n# ---------------------\nLLM_MODEL_EMOTION = \"gpt-4o-mini\"\nLLM_MODEL_SUMMARY = \"gpt-4o-mini\"\n# ---------------------\n# Camera Setting\n# ---------------------\n# 鏡頭設定",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "LLM_MODEL_EMOTION",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "LLM_MODEL_EMOTION = \"gpt-4o-mini\"\nLLM_MODEL_SUMMARY = \"gpt-4o-mini\"\n# ---------------------\n# Camera Setting\n# ---------------------\n# 鏡頭設定\n# 建議：0 通常是內建鏡頭 (Face)，1 通常是外接 USB 鏡頭 (Plate)\nCAMERA_INDEX_FACE = 1   \nCAMERA_INDEX_PLATE = 0\n# 給 LiveAnalyzer 用的索引（保持一致）",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "LLM_MODEL_SUMMARY",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "LLM_MODEL_SUMMARY = \"gpt-4o-mini\"\n# ---------------------\n# Camera Setting\n# ---------------------\n# 鏡頭設定\n# 建議：0 通常是內建鏡頭 (Face)，1 通常是外接 USB 鏡頭 (Plate)\nCAMERA_INDEX_FACE = 1   \nCAMERA_INDEX_PLATE = 0\n# 給 LiveAnalyzer 用的索引（保持一致）\nFACE_CAM_INDEX = CAMERA_INDEX_FACE   # = 0",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "CAMERA_INDEX_FACE",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "CAMERA_INDEX_FACE = 1   \nCAMERA_INDEX_PLATE = 0\n# 給 LiveAnalyzer 用的索引（保持一致）\nFACE_CAM_INDEX = CAMERA_INDEX_FACE   # = 0\nPLATE_CAM_INDEX = CAMERA_INDEX_PLATE # = 1\n# 解析度可以分開設定，例如餐盤需要高畫質看細節，人臉只需要 720p\nFACE_CAM_RES = (1280, 720)\nPLATE_CAM_RES = (1920, 1080)\nCAMERA_RESOLUTION_WIDTH = 1280\nCAMERA_RESOLUTION_HEIGHT = 720",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "CAMERA_INDEX_PLATE",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "CAMERA_INDEX_PLATE = 0\n# 給 LiveAnalyzer 用的索引（保持一致）\nFACE_CAM_INDEX = CAMERA_INDEX_FACE   # = 0\nPLATE_CAM_INDEX = CAMERA_INDEX_PLATE # = 1\n# 解析度可以分開設定，例如餐盤需要高畫質看細節，人臉只需要 720p\nFACE_CAM_RES = (1280, 720)\nPLATE_CAM_RES = (1920, 1080)\nCAMERA_RESOLUTION_WIDTH = 1280\nCAMERA_RESOLUTION_HEIGHT = 720\nCAMERA_BUFFER_SIZE = 2",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "FACE_CAM_INDEX",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "FACE_CAM_INDEX = CAMERA_INDEX_FACE   # = 0\nPLATE_CAM_INDEX = CAMERA_INDEX_PLATE # = 1\n# 解析度可以分開設定，例如餐盤需要高畫質看細節，人臉只需要 720p\nFACE_CAM_RES = (1280, 720)\nPLATE_CAM_RES = (1920, 1080)\nCAMERA_RESOLUTION_WIDTH = 1280\nCAMERA_RESOLUTION_HEIGHT = 720\nCAMERA_BUFFER_SIZE = 2\nEMOTE_INTERVAL_SECONDS = 1.5\n# ---------------------",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "PLATE_CAM_INDEX",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "PLATE_CAM_INDEX = CAMERA_INDEX_PLATE # = 1\n# 解析度可以分開設定，例如餐盤需要高畫質看細節，人臉只需要 720p\nFACE_CAM_RES = (1280, 720)\nPLATE_CAM_RES = (1920, 1080)\nCAMERA_RESOLUTION_WIDTH = 1280\nCAMERA_RESOLUTION_HEIGHT = 720\nCAMERA_BUFFER_SIZE = 2\nEMOTE_INTERVAL_SECONDS = 1.5\n# ---------------------\n# Head Gesture Detection (Nod & Shake)",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "FACE_CAM_RES",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "FACE_CAM_RES = (1280, 720)\nPLATE_CAM_RES = (1920, 1080)\nCAMERA_RESOLUTION_WIDTH = 1280\nCAMERA_RESOLUTION_HEIGHT = 720\nCAMERA_BUFFER_SIZE = 2\nEMOTE_INTERVAL_SECONDS = 1.5\n# ---------------------\n# Head Gesture Detection (Nod & Shake)\n# ---------------------\n# 採用嚴格版偵測參數",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "PLATE_CAM_RES",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "PLATE_CAM_RES = (1920, 1080)\nCAMERA_RESOLUTION_WIDTH = 1280\nCAMERA_RESOLUTION_HEIGHT = 720\nCAMERA_BUFFER_SIZE = 2\nEMOTE_INTERVAL_SECONDS = 1.5\n# ---------------------\n# Head Gesture Detection (Nod & Shake)\n# ---------------------\n# 採用嚴格版偵測參數\nGESTURE_BUFFER_LEN = 20           # 緩衝長度",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "CAMERA_RESOLUTION_WIDTH",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "CAMERA_RESOLUTION_WIDTH = 1280\nCAMERA_RESOLUTION_HEIGHT = 720\nCAMERA_BUFFER_SIZE = 2\nEMOTE_INTERVAL_SECONDS = 1.5\n# ---------------------\n# Head Gesture Detection (Nod & Shake)\n# ---------------------\n# 採用嚴格版偵測參數\nGESTURE_BUFFER_LEN = 20           # 緩衝長度\nGESTURE_COOLDOWN_SECONDS = 1.0    # 冷卻時間",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "CAMERA_RESOLUTION_HEIGHT",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "CAMERA_RESOLUTION_HEIGHT = 720\nCAMERA_BUFFER_SIZE = 2\nEMOTE_INTERVAL_SECONDS = 1.5\n# ---------------------\n# Head Gesture Detection (Nod & Shake)\n# ---------------------\n# 採用嚴格版偵測參數\nGESTURE_BUFFER_LEN = 20           # 緩衝長度\nGESTURE_COOLDOWN_SECONDS = 1.0    # 冷卻時間\nGESTURE_MIN_OFFSET = 0.002        # 去抖動門檻",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "CAMERA_BUFFER_SIZE",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "CAMERA_BUFFER_SIZE = 2\nEMOTE_INTERVAL_SECONDS = 1.5\n# ---------------------\n# Head Gesture Detection (Nod & Shake)\n# ---------------------\n# 採用嚴格版偵測參數\nGESTURE_BUFFER_LEN = 20           # 緩衝長度\nGESTURE_COOLDOWN_SECONDS = 1.0    # 冷卻時間\nGESTURE_MIN_OFFSET = 0.002        # 去抖動門檻\n# 判定參數",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "EMOTE_INTERVAL_SECONDS",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "EMOTE_INTERVAL_SECONDS = 1.5\n# ---------------------\n# Head Gesture Detection (Nod & Shake)\n# ---------------------\n# 採用嚴格版偵測參數\nGESTURE_BUFFER_LEN = 20           # 緩衝長度\nGESTURE_COOLDOWN_SECONDS = 1.0    # 冷卻時間\nGESTURE_MIN_OFFSET = 0.002        # 去抖動門檻\n# 判定參數\nNOD_AMP_THRESH = 0.015            # Y 軸振幅門檻 (點頭)",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "GESTURE_BUFFER_LEN",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "GESTURE_BUFFER_LEN = 20           # 緩衝長度\nGESTURE_COOLDOWN_SECONDS = 1.0    # 冷卻時間\nGESTURE_MIN_OFFSET = 0.002        # 去抖動門檻\n# 判定參數\nNOD_AMP_THRESH = 0.015            # Y 軸振幅門檻 (點頭)\nSHAKE_AMP_THRESH = 0.020          # X 軸振幅門檻 (搖頭)\nMAX_SECONDARY_AMP = 0.010         # 非主軸的最大容許振幅 (超過則視為模糊動作)\nMIN_OSC_COUNT = 3                 # 最小來回次數\n# --------------------\n# Plate Detection",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "GESTURE_COOLDOWN_SECONDS",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "GESTURE_COOLDOWN_SECONDS = 1.0    # 冷卻時間\nGESTURE_MIN_OFFSET = 0.002        # 去抖動門檻\n# 判定參數\nNOD_AMP_THRESH = 0.015            # Y 軸振幅門檻 (點頭)\nSHAKE_AMP_THRESH = 0.020          # X 軸振幅門檻 (搖頭)\nMAX_SECONDARY_AMP = 0.010         # 非主軸的最大容許振幅 (超過則視為模糊動作)\nMIN_OSC_COUNT = 3                 # 最小來回次數\n# --------------------\n# Plate Detection\n# --------------------",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "GESTURE_MIN_OFFSET",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "GESTURE_MIN_OFFSET = 0.002        # 去抖動門檻\n# 判定參數\nNOD_AMP_THRESH = 0.015            # Y 軸振幅門檻 (點頭)\nSHAKE_AMP_THRESH = 0.020          # X 軸振幅門檻 (搖頭)\nMAX_SECONDARY_AMP = 0.010         # 非主軸的最大容許振幅 (超過則視為模糊動作)\nMIN_OSC_COUNT = 3                 # 最小來回次數\n# --------------------\n# Plate Detection\n# --------------------\nYOLO_MODEL_PATH = \"yolov8n.pt\"",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "NOD_AMP_THRESH",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "NOD_AMP_THRESH = 0.015            # Y 軸振幅門檻 (點頭)\nSHAKE_AMP_THRESH = 0.020          # X 軸振幅門檻 (搖頭)\nMAX_SECONDARY_AMP = 0.010         # 非主軸的最大容許振幅 (超過則視為模糊動作)\nMIN_OSC_COUNT = 3                 # 最小來回次數\n# --------------------\n# Plate Detection\n# --------------------\nYOLO_MODEL_PATH = \"yolov8n.pt\"\nFOODISH_CLASSES = {\n    \"cake\", \"pizza\", \"hot dog\", \"banana\", \"apple\", \"sandwich\", \"orange\",",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "SHAKE_AMP_THRESH",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "SHAKE_AMP_THRESH = 0.020          # X 軸振幅門檻 (搖頭)\nMAX_SECONDARY_AMP = 0.010         # 非主軸的最大容許振幅 (超過則視為模糊動作)\nMIN_OSC_COUNT = 3                 # 最小來回次數\n# --------------------\n# Plate Detection\n# --------------------\nYOLO_MODEL_PATH = \"yolov8n.pt\"\nFOODISH_CLASSES = {\n    \"cake\", \"pizza\", \"hot dog\", \"banana\", \"apple\", \"sandwich\", \"orange\",\n    \"broccoli\", \"carrot\", \"bowl\", \"cup\", \"wine glass\", \"bottle\", \"spoon\",",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "MAX_SECONDARY_AMP",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "MAX_SECONDARY_AMP = 0.010         # 非主軸的最大容許振幅 (超過則視為模糊動作)\nMIN_OSC_COUNT = 3                 # 最小來回次數\n# --------------------\n# Plate Detection\n# --------------------\nYOLO_MODEL_PATH = \"yolov8n.pt\"\nFOODISH_CLASSES = {\n    \"cake\", \"pizza\", \"hot dog\", \"banana\", \"apple\", \"sandwich\", \"orange\",\n    \"broccoli\", \"carrot\", \"bowl\", \"cup\", \"wine glass\", \"bottle\", \"spoon\",\n    \"fork\", \"knife\", \"plate\"",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "MIN_OSC_COUNT",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "MIN_OSC_COUNT = 3                 # 最小來回次數\n# --------------------\n# Plate Detection\n# --------------------\nYOLO_MODEL_PATH = \"yolov8n.pt\"\nFOODISH_CLASSES = {\n    \"cake\", \"pizza\", \"hot dog\", \"banana\", \"apple\", \"sandwich\", \"orange\",\n    \"broccoli\", \"carrot\", \"bowl\", \"cup\", \"wine glass\", \"bottle\", \"spoon\",\n    \"fork\", \"knife\", \"plate\"\n}",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "YOLO_MODEL_PATH",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "YOLO_MODEL_PATH = \"yolov8n.pt\"\nFOODISH_CLASSES = {\n    \"cake\", \"pizza\", \"hot dog\", \"banana\", \"apple\", \"sandwich\", \"orange\",\n    \"broccoli\", \"carrot\", \"bowl\", \"cup\", \"wine glass\", \"bottle\", \"spoon\",\n    \"fork\", \"knife\", \"plate\"\n}",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "FOODISH_CLASSES",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "FOODISH_CLASSES = {\n    \"cake\", \"pizza\", \"hot dog\", \"banana\", \"apple\", \"sandwich\", \"orange\",\n    \"broccoli\", \"carrot\", \"bowl\", \"cup\", \"wine glass\", \"bottle\", \"spoon\",\n    \"fork\", \"knife\", \"plate\"\n}",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "frame_placeholder1",
        "kind": 5,
        "importPath": "test_cam",
        "description": "test_cam",
        "peekOfCode": "frame_placeholder1 = col1.empty()\nframe_placeholder2 = col2.empty()\n# 你的兩個鏡頭\ncap1 = cv2.VideoCapture(1)\ncap2 = cv2.VideoCapture(0)  # 如果是 Camo (iPhone)，通常是 1\nwhile True:\n    ret1, f1 = cap1.read()\n    ret2, f2 = cap2.read()\n    if ret1:\n        frame_placeholder1.image(f1, channels=\"BGR\")",
        "detail": "test_cam",
        "documentation": {}
    },
    {
        "label": "frame_placeholder2",
        "kind": 5,
        "importPath": "test_cam",
        "description": "test_cam",
        "peekOfCode": "frame_placeholder2 = col2.empty()\n# 你的兩個鏡頭\ncap1 = cv2.VideoCapture(1)\ncap2 = cv2.VideoCapture(0)  # 如果是 Camo (iPhone)，通常是 1\nwhile True:\n    ret1, f1 = cap1.read()\n    ret2, f2 = cap2.read()\n    if ret1:\n        frame_placeholder1.image(f1, channels=\"BGR\")\n    if ret2:",
        "detail": "test_cam",
        "documentation": {}
    },
    {
        "label": "cap1",
        "kind": 5,
        "importPath": "test_cam",
        "description": "test_cam",
        "peekOfCode": "cap1 = cv2.VideoCapture(1)\ncap2 = cv2.VideoCapture(0)  # 如果是 Camo (iPhone)，通常是 1\nwhile True:\n    ret1, f1 = cap1.read()\n    ret2, f2 = cap2.read()\n    if ret1:\n        frame_placeholder1.image(f1, channels=\"BGR\")\n    if ret2:\n        frame_placeholder2.image(f2, channels=\"BGR\")\n    time.sleep(0.03)  # 避免爆 CPU（30 FPS）",
        "detail": "test_cam",
        "documentation": {}
    },
    {
        "label": "cap2",
        "kind": 5,
        "importPath": "test_cam",
        "description": "test_cam",
        "peekOfCode": "cap2 = cv2.VideoCapture(0)  # 如果是 Camo (iPhone)，通常是 1\nwhile True:\n    ret1, f1 = cap1.read()\n    ret2, f2 = cap2.read()\n    if ret1:\n        frame_placeholder1.image(f1, channels=\"BGR\")\n    if ret2:\n        frame_placeholder2.image(f2, channels=\"BGR\")\n    time.sleep(0.03)  # 避免爆 CPU（30 FPS）",
        "detail": "test_cam",
        "documentation": {}
    }
]